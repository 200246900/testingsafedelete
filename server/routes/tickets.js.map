{"version":3,"sources":["routes/tickets.ts"],"names":[],"mappings":"AAAA,IAAO,OAAO,WAAW,SAAS,CAAC,CAAC;AACpC,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;AAI9B,IAAO,YAAY,WAAW,mBAAmB,CAAC,CAAC;AAEnD,IAAO,OAAO,GAAG,YAAY,CAAC,OAAO,CAAC;AAEtC,gCAAgC;AAChC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,UAAC,GAAoB,EAAE,GAAqB,EAAE,IAAS;IAEnE,yDAAyD;IACzD,OAAO,CAAC,IAAI,CAAC,UAAS,KAAK,EAAE,QAAQ;QACjC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACR,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,wCAAwC;YACxC,GAAG,CAAC,MAAM,CAAC,gBAAgB,EAAE;gBACzB,KAAK,EAAE,UAAU;gBACjB,QAAQ,EAAE,QAAQ;aACrB,CAAC,CAAC;QACP,CAAC;IACL,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC;AAEH,qCAAqC;AACrC,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,UAAS,GAAoB,EAAE,GAAqB,EAAE,IAAS;IAC9E,GAAG,CAAC,MAAM,CAAC,cAAc,EAAE;QACvB,KAAK,EAAE,mBAAmB;KAC7B,CAAC,CAAC;AACP,CAAC,CAAC,CAAC;AAEH,uCAAuC;AACvC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,UAAS,GAAoB,EAAE,GAAqB,EAAE,IAAS;IAC/E,OAAO,CAAC,MAAM,CAAC;QACX,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK;QACrB,OAAO,EAAE,GAAG,CAAC,IAAI,CAAC,OAAO;KAC5B,EAAE,UAAS,KAAK,EAAE,OAAO;QACtB,oDAAoD;QACpD,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACR,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAC9B,CAAC;IACL,CAAC,CAAC,CAAA;AACN,CAAC,CAAC,CAAC;AAEH,uDAAuD;AACvD,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,UAAC,GAAoB,EAAE,GAAqB,EAAE,IAAS;IAEtE,IAAI,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC;IAEvB,OAAO,CAAC,QAAQ,CAAC,EAAE,EAAE,UAAC,KAAK,EAAE,OAAO;QAChC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACR,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,oBAAoB;YACpB,GAAG,CAAC,MAAM,CAAC,eAAe,EAAE;gBACxB,KAAK,EAAE,iBAAiB;gBACxB,OAAO,EAAE,OAAO;aACnB,CAAC,CAAC;QACP,CAAC;IACL,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC;AAEH,+CAA+C;AAC/C,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,UAAC,GAAoB,EAAE,GAAqB,EAAE,IAAS;IAEvE,qCAAqC;IACrC,IAAI,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC;IAEvB,wCAAwC;IACxC,IAAI,OAAO,GAAG,IAAI,OAAO,CAAC;QACtB,GAAG,EAAE,EAAE;QACP,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK;QACrB,OAAO,EAAE,GAAG,CAAC,IAAI,CAAC,OAAO;KAC5B,CAAC,CAAC;IAEH,8CAA8C;IAC9C,OAAO,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,UAAC,KAAK;QACvC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACR,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAC9B,CAAC;IACL,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC;AAEH,qBAAqB;AACrB,MAAM,CAAC,GAAG,CAAC,aAAa,EAAE,UAAC,GAAoB,EAAE,GAAqB,EAAE,IAAS;IAE7E,0BAA0B;IAC1B,IAAI,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC;IAEvB,uCAAuC;IACvC,OAAO,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,UAAC,KAAK;QAC9B,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACR,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAC9B,CAAC;IACL,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC;AAEH,mBAAmB;AACnB,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC","file":"routes/tickets.js","sourcesContent":["import express = require('express');\nvar router = express.Router();\n\n// db references\nimport mongoose = require('mongoose');\nimport ticketModel = require('../models/ticket');\n\nimport Ticket = ticketModel.Ticket;\n\n// GET - show main aritcles page\nrouter.get('/', (req: express.Request, res: express.Response, next: any) => {\n   \n    // use the Ticket model to query the Tickets collection\n    Ticket.find(function(error, tickets) {\n        if (error) {\n            console.log(error);\n            res.end(error);\n        }\n        else {\n            // no error, we found a list of tickets\n            res.render('tickets/index', {\n                title: 'Tickets',\n                tickets: tickets\n            });\n        }\n    });\n});\n\n// GET add page - show the blank form\nrouter.get('/add', function(req: express.Request, res: express.Response, next: any) {\n    res.render('tickets/add', {\n        title: 'Add a New Ticket'\n    });\n});\n\n// POST add page - save the new ticket\nrouter.post('/add', function(req: express.Request, res: express.Response, next: any) {\n    Ticket.create({\n        title: req.body.title,\n        content: req.body.content\n    }, function(error, Ticket) {\n        // did we get back an error or valid Ticket object?\n        if (error) {\n            console.log(error);\n            res.end(error);\n        }\n        else {\n            res.redirect('/tickets');\n        }\n    })\n});\n\n// GET edit page - show the current ticket in the form\nrouter.get('/:id', (req: express.Request, res: express.Response, next: any) => {\n\n    var id = req.params.id;\n\n    Ticket.findById(id, (error, Ticket) => {\n        if (error) {\n            console.log(error);\n            res.end(error);\n        }\n        else {\n            //show the edit view\n            res.render('tickets/edit', {\n                title: 'Ticket Details',\n                ticket: Ticket\n            });\n        }\n    });\n});\n\n// POST edit page - update the selected ticket\nrouter.post('/:id', (req: express.Request, res: express.Response, next: any) => {\n\n    // grab the id from the url parameter\n    var id = req.params.id;\n\n    // create and populate an ticket object\n    var ticket = new Ticket({\n        _id: id,\n        title: req.body.title,\n        content: req.body.content\n    });\n\n    // run the update using mongoose and our model\n    Ticket.update({ _id: id }, ticket, (error) => {\n        if (error) {\n            console.log(error);\n            res.end(error);\n        }\n        else {\n            res.redirect('/tickets');\n        }\n    });\n});\n\n// GET delete ticket\nrouter.get('/delete/:id', (req: express.Request, res: express.Response, next: any) => {\n\n    // get the id from the url\n    var id = req.params.id;\n\n    // use the model and delete this record\n    Ticket.remove({ _id: id }, (error) => {\n        if (error) {\n            console.log(error);\n            res.end(error);\n        }\n        else {\n            res.redirect('/tickets');\n        }\n    });\n});\n\n// make this public\nmodule.exports = router;"],"sourceRoot":"/source/"}